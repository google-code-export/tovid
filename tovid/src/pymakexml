#! /usr/bin/env python
# pymakexml

__doc__ = \
"""Generate vcdimager/dvdauthor XML for an (S)VCD/DVD disc (to replace the
'makexml' shell script).
"""

import sys
from libtovid.opts import Option, OptionDict
from libtovid.author import dvdauthor, vcdimager
from libtovid.layout import Disc

# List of valid options with documentation
OPTION_DEFS = [
    Option('out', 'NAME', None,
        """Output prefix or disc name."""),
    Option('format', 'vcd|svcd|dvd', 'dvd',
        """Create a disc of the specified format."""),
    Option('tvsys', 'pal|ntsc', 'ntsc',
        """Make the disc for the specified TV system."""),
    Option('topmenu', 'MENUNAME', None,
        """Use MENUNAME for the top-level menu on the disc.""")
]

options = OptionDict(OPTION_DEFS)

if __name__ == '__main__':
    """Create a Disc with the given options and generate the XML for it."""
    # If no arguments were provided, print usage notes
    # TODO: Proper argument verification
    if len(sys.argv) < 2:
        print "Usage: pymakexml [options] vid1.mpg vid2.mpg ... -out NAME"
        print "Where [options] may be any of the following:"
        print options.usage()
        print "Please provide an output name with -out."
        sys.exit()

    options.override(sys.argv[1:])
    # TODO: Fix this. May need to add more OPTION_DEFS
    disc = Disc(args)
    if options['format'] == 'dvd':
        dvdauthor.get_xml(disc)
    else:
        vcdimager.get_xml(disc)
